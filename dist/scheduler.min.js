var schedulerjsTemplates=function(){var a={layout:new Hogan.Template({code:function(a,b,c){var d=this;return d.b(c=c||""),d.b('<div class="sjs-name-col">\r'),d.b("\n"+c),d.b('    <div class="sjs-name-head"></div>\r'),d.b("\n"+c),d.s(d.f("names",a,b,1),a,b,0,81,133,"{{ }}")&&(d.rs(a,b,function(a,b,d){d.b('        <div class="sjs-name">'),d.b(d.v(d.f("name",a,b,0))),d.b("</div>\r"),d.b("\n"+c)}),a.pop()),d.b("</div>\r"),d.b("\n"+c),d.b('<div class="sjs-app-col">\r'),d.b("\n"+c),d.b('    <div class="sjs-grid">\r'),d.b("\n"+c),d.b('        <div class="sjs-grid-row-head">\r'),d.b("\n"+c),d.s(d.f("grid-cols-head",a,b,1),a,b,0,280,424,"{{ }}")&&(d.rs(a,b,function(a,b,d){d.b('                <div class="sjs-grid-col-head" style="width:'),d.b(d.v(d.f("width",a,b,0))),d.b('px;">\r'),d.b("\n"+c),d.b("                    "),d.b(d.v(d.f("time",a,b,0))),d.b("\r"),d.b("\n"+c),d.b("                </div>\r"),d.b("\n"+c)}),a.pop()),d.b("        </div>\r"),d.b("\n"+c),d.s(d.f("grid-rows",a,b,1),a,b,0,483,698,"{{ }}")&&(d.rs(a,b,function(a,b,d){d.b('            <div class="sjs-grid-row">\r'),d.b("\n"+c),d.s(d.f("grid-cols",a,b,1),a,b,0,555,654,"{{ }}")&&(d.rs(a,b,function(a,b,d){d.b('                    <div class="sjs-grid-col" style="width:'),d.b(d.v(d.f("width",a,b,0))),d.b('px;"></div>\r'),d.b("\n"+c)}),a.pop()),d.b("            </div>\r"),d.b("\n"+c)}),a.pop()),d.b("    </div>\r"),d.b("\n"+c),d.b('    <div class="sjs-grid-overlay">\r'),d.b("\n"+c),d.b('        <div class="sjs-grid-overlay-row-head"></div>\r'),d.b("\n"+c),d.s(d.f("grid-overlay-rows",a,b,1),a,b,0,847,1382,"{{ }}")&&(d.rs(a,b,function(a,b,d){d.b('            <div class="sjs-grid-overlay-row">\r'),d.b("\n"+c),d.s(d.f("grid-overlay-cols",a,b,1),a,b,0,935,1330,"{{ }}")&&(d.rs(a,b,function(a,b,d){d.b('                    <div class="sjs-grid-overlay-col" style="width:'),d.b(d.v(d.f("width",a,b,0))),d.b("px;margin-left:"),d.b(d.v(d.f("margin",a,b,0))),d.b('px;" title="'),d.b(d.v(d.f("title",a,b,0))),d.b(" "),d.b(d.v(d.f("start",a,b,0))),d.b("-"),d.b(d.v(d.f("end",a,b,0))),d.b('">\r'),d.b("\n"+c),d.b('                        <span class="sjs-grid-overlay-col-title">'),d.b(d.v(d.f("title",a,b,0))),d.b("</span>\r"),d.b("\n"+c),d.b("                        <br />\r"),d.b("\n"+c),d.b('                        <span class="sjs-grid-overlay-col-time">'),d.b(d.v(d.f("start",a,b,0))),d.b("-"),d.b(d.v(d.f("end",a,b,0))),d.b("</span>\r"),d.b("\n"+c),d.b("                    </div>\r"),d.b("\n"+c)}),a.pop()),d.b("            </div>\r"),d.b("\n"+c)}),a.pop()),d.b("    </div>\r"),d.b("\n"+c),d.b('    <div class="sjs-fill-height"></div>\r'),d.b("\n"+c),d.b('    <div class="sjs-selector" data-selector="start">\r'),d.b("\n"+c),d.b('        <div class="sjs-selector-inner">\r'),d.b("\n"+c),d.b('            <div class="sjs-selector-text">Start</div>\r'),d.b("\n"+c),d.b("        </div>\r"),d.b("\n"+c),d.b("    </div>\r"),d.b("\n"+c),d.b('    <div class="sjs-selector" data-selector="end">\r'),d.b("\n"+c),d.b('        <div class="sjs-selector-inner">\r'),d.b("\n"+c),d.b('            <div class="sjs-selector-text">End</div>\r'),d.b("\n"+c),d.b("        </div>\r"),d.b("\n"+c),d.b("    </div>\r"),d.b("\n"+c),d.b("</div>"),d.fl()},partials:{},subs:{}})},b=function(b){var c=a[b];return function(b,d,e){return c.render(b,d||a,e)}};return{layout:b("layout")}}();!function(a,b,c,d){function e(b,c){this.element=b,this.opts=a.extend({},e.defaults,c),this.minMinutes=0,this.maxMinutes=1440,this.selectedStartTime=0,this.selectedEndTime=0,this.stepsMinutes=[],this.nameList=[],this.createView(),this.setListeners(),this.selectedStartTime=this.minMinutes+60,this.selectedEndTime=this.minMinutes+120,this.updateSelectors()}e.defaults={pixelsPerHour:200,snapTo:5,steps:["08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00"],list:[]},e.prototype["public"]={selected:function(){return{start:this.minutesToTimeStr(this.selectedStartTime),end:this.minutesToTimeStr(this.selectedEndTime)}}},e.prototype.setListeners=function(){var b=this,c=null;this.element.on("mousemove",function(a){c&&b.moveSelector(c,a.pageX)}),this.element.on("mousedown",".sjs-selector",function(b){c=a(this)}),this.element.on("mouseup",function(a){c&&b.snapSelector(c),c=null}),this.element.on("mouseleave",function(a){c&&b.snapSelector(c),c=null})},e.prototype.updateSelectors=function(){this.moveSelector(this.element.find('.sjs-selector[data-selector="start"]'),this.minutesToPageOffset(this.selectedStartTime)),this.moveSelector(this.element.find('.sjs-selector[data-selector="end"]'),this.minutesToPageOffset(this.selectedEndTime))},e.prototype.moveSelector=function(a,b){a.offset({left:b});var c=this.pageOffsetToMinutes(b);a.find(".sjs-selector-text").html(this.minutesToTimeStr(c)),"start"==a.data("selector")?this.selectedStartTime=c:this.selectedEndTime=c,this.selectedStartTime<this.minMinutes?(this.selectedStartTime=this.minMinutes,this.updateSelectors()):this.selectedStartTime>this.maxMinutes&&(this.selectedStartTime=this.maxMinutes,this.updateSelectors()),this.selectedEndTime<this.minMinutes?(this.selectedEndTime=this.minMinutes,this.updateSelectors()):this.selectedEndTime>this.maxMinutes&&(this.selectedEndTime=this.maxMinutes,this.updateSelectors()),this.selectedStartTime>this.selectedEndTime&&(this.selectedEndTime=this.selectedStartTime,this.updateSelectors())},e.prototype.snapSelector=function(a){var b,c,d;"start"==a.data("selector")?(c=this.selectedStartTime%this.opts.snapTo,d=c>this.opts.snapTo/2?c-this.opts.snapTo:c,this.selectedStartTime-=d,b=this.minutesToPageOffset(this.selectedStartTime)):(c=this.selectedEndTime%this.opts.snapTo,d=c>this.opts.snapTo/2?c-this.opts.snapTo:c,this.selectedEndTime-=d,b=this.minutesToPageOffset(this.selectedEndTime)),this.moveSelector(a,b)},e.prototype.pageOffsetToMinutes=function(a){var b=this.element.find(".sjs-grid").first().offset().left;return Math.round(60*(a-b)/this.opts.pixelsPerHour)+this.minMinutes},e.prototype.minutesToPageOffset=function(a){var b=this.element.find(".sjs-grid").first().offset().left;return this.minutesToPixels(a-this.minMinutes)+b},e.prototype.minutesToPixels=function(a){return Math.round(a*this.opts.pixelsPerHour/60)},e.prototype.timeStrToMinutes=function(a){var b=a.split(":");return 60*parseInt(b[0])+parseInt(b[1])},e.prototype.minutesToTimeStr=function(a){var b=Math.floor(a/60),c=a-60*b,d="";return d=10>b?"0"+String(b):String(b),d+=10>c?":0"+String(c):":"+String(c)},e.prototype.getGridOverlayRowData=function(){for(var a=[],b=0;b<this.opts.list.length;b++){for(var c=this.minMinutes,d=[],e=0;e<this.opts.list[b].appointments.length;e++){var f=this.opts.list[b].appointments[e],g=this.timeStrToMinutes(f.start),h=this.timeStrToMinutes(f.end);if(!(g>h)){h>this.maxMinutes&&(h=this.maxMinutes),g<this.minMinutes&&(g=this.minMinutes);var i=h-g,j=g-c;c=h,d.push({width:this.minutesToPixels(i),margin:this.minutesToPixels(j),title:f.title,start:f.start,end:f.end})}}a.push({"grid-overlay-cols":d})}return a},e.prototype.createView=function(){this.nameList=this.opts.list.map(function(a){return{name:a.name}}),this.stepsMinutes=this.opts.steps.map(this.timeStrToMinutes),this.minMinutes=Math.min.apply(Math,this.stepsMinutes),this.maxMinutes=Math.max.apply(Math,this.stepsMinutes);for(var a=[],b=[],c=0;c<this.stepsMinutes.length-1;c++){var d=this.stepsMinutes[c+1]-this.stepsMinutes[c];a.push({width:this.minutesToPixels(d),time:this.opts.steps[c]}),b.push({width:this.minutesToPixels(d)})}var e=[];for(c=0;c<this.opts.list.length;c++)e.push({"grid-cols":b});this.element.html(schedulerjsTemplates.layout({names:this.nameList,"grid-cols-head":a,"grid-rows":e,"grid-overlay-rows":this.getGridOverlayRowData()}));var f=this.element.find(".sjs-grid").first().height(),g=30,h=16;this.element.find(".sjs-fill-height").first().height(f+g),this.element.find(".sjs-selector").height(f+g-h)},a.fn.schedulerjs=function(b){var c,f=arguments,g="schedulerjs";return this.each(function(){var d;if(!a.data(this,g)){if("object"!=typeof b)return void a.error(g+" needs an options object for initialization.");a.data(this,g,new e(a(this),b))}d=a.data(this,g),"object"!=typeof b&&(d["public"][b]?c=d["public"][b].apply(d,Array.prototype.slice(f,1)):a.error("Method "+b+" does not exist in "+g))}),c!==d?c:this}}(jQuery,window,document);